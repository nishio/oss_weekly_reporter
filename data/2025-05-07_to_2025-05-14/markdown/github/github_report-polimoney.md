# GitHub レポート: digitaldemocracy2030/polimoney

期間: 2025-05-07T17:37:59.080922+09:00 から 2025-05-14T17:37:59.080922+09:00 まで

## Issues

### 過去7日間に完了されたissue (5件)

### [test](https://github.com/digitaldemocracy2030/polimoney/issues/56)

**作成者:** moai-redcap  
**作成日:** 2025-05-12T12:29:32Z  
**内容:**

## 解決・改善したいこと

<!-- この提案はどのようなものかを説明してください。また、どのような人がどのように嬉しい提案なのかを、できればユーザーを主語にして記載してください。 -->

<!-- 対象画面の URL や関連する議論や資料の URL があれば、添付いただけると理解の助けになります。 -->

## 具体的な実現方法・実装方法の概要（未記入でも構いません）


**コメント:** なし

---

### [Issue→projectsテスト](https://github.com/digitaldemocracy2030/polimoney/issues/53)

**作成者:** moai-redcap  
**作成日:** 2025-05-12T06:03:01Z  
**内容:**

内容なし

**コメント:** なし

---

### [issue templateを用意する](https://github.com/digitaldemocracy2030/polimoney/issues/18)

**作成者:** adust09  
**作成日:** 2025-04-23T13:35:15Z  
**内容:**

**目的**
- 新規参加者(開発者)のオンボーディングコストを下げる
- 多くの開発者間のコミュニケーションコストを下げる

**実装イメージ**
kouchou-aiのテンプレを使えそう
https://github.com/digitaldemocracy2030/kouchou-ai/tree/main/.github/ISSUE_TEMPLATE

**コメント:** なし

---

### [データ引用元のURLを貼る](https://github.com/digitaldemocracy2030/polimoney/issues/17)

**作成者:** adust09  
**作成日:** 2025-04-23T13:31:23Z  
**内容:**

**目的**
- ソースを知りたいユーザーのUXを向上させる
- Polimoney自体の透明性を向上させる

**実装イメージ**
画像のハイライト部分をクリックするとソースに飛ぶようにする
<img width="1031" alt="Image" src="https://github.com/user-attachments/assets/f68044c3-213f-4460-bea2-e26b9226e9f8" />

**参考**
政治資金収支報告書データベースでは似たような機能が実装されている
ex: 
https://political-finance-database.com/politician_detail/1744011775449x224006594647899970

**コメント:** なし

---

### [LICENSE / CLAを書く](https://github.com/digitaldemocracy2030/polimoney/issues/12)

**作成者:** takahiroanno  
**作成日:** 2025-04-21T12:09:03Z  
**内容:**

diitaldemocracy2030/kouchou-ai に準拠で良い

**コメント:** なし

---

### 過去7日間に作成されたissue (3件)

### [TypeScriptのフォーマッターの導入](https://github.com/digitaldemocracy2030/polimoney/issues/54)

**作成者:** dotneet  
**作成日:** 2025-05-12T08:00:00Z  
**内容:**

biomeかprettierを導入してコードフォーマットが個々の環境に依存しないようにしたいです。
[kouchou-ai](https://github.com/digitaldemocracy2030/kouchou-ai/blob/main/biome.json) では biome 使ってますし、eslintをはずして biome にするのが良さそうな気がしますがどうでしょう。



**コメント:** なし

---

### [CONTRIBUTING.mdを作成する](https://github.com/digitaldemocracy2030/polimoney/issues/51)

**作成者:** adust09  
**作成日:** 2025-05-12T02:04:44Z  
**内容:**

CONTRIBUTING.mdとはOSSへコミットする際のissue作成やPR作成の手順を記した文書である。
issue templateやPR templateが[用意](https://github.com/digitaldemocracy2030/polimoney/pull/49)されたので、コントリビューションガイドも提供したい。

参考：https://zenn.dev/wakamsha/articles/encouragement-of-contributing-guide

**コメント:** なし

---

### [検索結果のサムネイルを差し替える](https://github.com/digitaldemocracy2030/polimoney/issues/46)

**作成者:** adust09  
**作成日:** 2025-05-07T14:27:14Z  
**内容:**

検索結果一覧に表示されるサムネイルが出井さんになっている
当プロジェクトを公共性の高いものとするために別の画像に差し替えることが望ましい。

![Image](https://github.com/user-attachments/assets/addd73ff-f66d-4c54-931a-f5c4c83c1e95)

以下のような点から議論をスタートすると良さそう

- 現段階で適当なサムネ画像があるか？
- 現在のOGP画像で代替するか？
- サムネイルやアイコンを新規デザインするか？



**コメント:** なし

---

### 過去7日間に更新されたissue（作成・クローズを除く）(11件)

### [対内外向け[資料露出]](https://github.com/digitaldemocracy2030/polimoney/issues/41)

**作成者:** cKinu  
**作成日:** 2025-05-02T18:30:00Z  
**内容:**

**発進方法案**
**発信の目的:**
認知度向上による利用者数、ボランティア数の増加
**フォーマル発信**
- ターゲット
> - ユーザー、ビューアー共に
- 露出先
> - PRTIMESや公式Youtube
- 何を
> - ポンチ絵と営業資料
- 目的
> - 国民の信頼につながる、政治献金につながる、手軽に導入できるための流入間口を広げる

**カジュアル発信**
- ターゲット
> - ビューアーに絞る場合
> > - 新規、ネームのみ認知あり、認知あり興味を深めたいの3層に分けて添付資料を変えて発信
> > - デジ民2030の紹介は全てに必ず入れる
- 露出先
> - X?
- 何を
> - ビューアーの層に合わせ添付資料変更
- 目的
> - ボランティア数の増加
> - 政治資金の関心深度とツール利活用の向上

備忘
営業資料は、メールで国会議員一括送信という手も詳細詰める

**コメント:** なし

---

### [対内外向け[資料作成]](https://github.com/digitaldemocracy2030/polimoney/issues/40)

**作成者:** cKinu  
**作成日:** 2025-05-02T18:22:55Z  
**内容:**

**改善施策として資料作成をする目的:**
- 内からの訴求内容の一律
- 外からのツールを見た上での解釈揃え

**目標:**
- ユーザー
> - 国民の信頼につながる、政治献金につながる、手軽に導入できる
- ビューアー
> - 政治資金の関心深度とツール利活用の向上、推し活政治版（献金する）

**Todo:**
作成ツール: figma, GoogleSlide
- [ ] ポンチ絵　プロジェクト向け
- [ ] 営業資料　ユーザー向け
- [ ] プレゼン資料　ビューアー向け

**各種資料作成（イメージ案）**
Shimizuさんスライドとサイトを元に、必要ポイントをそれぞれにフォーカスした資料を作成
- ポンチ絵
> - 他のプロジェクトを踏襲し手書きなどの簡潔版
> - 担当のアイコンと立ち位置図をマトリクス表にペタペタ
- 営業資料（ユーザー向け）
> - ユーザーに刺さるメリット
> - 利用条件（スプシ使ってね）
> - 導入事例（ストーリー仕立て）
- プレゼン資料（ビューアー向け）
> - ユーザーへのメリット
> - 自分ごとに出来るような仕掛け
> - ストーリー仕立て
> - よくあるXの漫画広告形式とか？（推し活想定に因んで）

**コメント:** なし

---

### [Pythonのlinter、formatterを導入する](https://github.com/digitaldemocracy2030/polimoney/issues/34)

**作成者:** tdaira  
**作成日:** 2025-04-30T14:02:35Z  
**内容:**

- linter、formatterを導入する
- 型チェック等はまず入れてみて少しずつオプションを増やしていく方針にする

**コメント:** なし

---

### [議論：収支報告書に不記載(裏金)の情報について](https://github.com/digitaldemocracy2030/polimoney/issues/31)

**作成者:** nanocloudx  
**作成日:** 2025-04-30T13:35:30Z  
**内容:**

現時点のポリマネーは収支報告書に記載されている内容を見やすくすることを目的としている
元データである収支報告書に記載されていないものは当然掲載することができない
不記載(裏金)の情報に対するアプローチ（？）をどうするかという意見があった

**コメント:** なし

---

### [E2E動作確認（つなぎこみ）](https://github.com/digitaldemocracy2030/polimoney/issues/29)

**作成者:** nanocloudx  
**作成日:** 2025-04-30T13:26:32Z  
**内容:**

精度は悪くても良いので（OCR結果が間違っていることを許容して）、Gemini読み込みからHTML出力までを繋ぎこむ


**コメント:** なし

---

### [devcontainerを設定する](https://github.com/digitaldemocracy2030/polimoney/issues/25)

**作成者:** adust09  
**作成日:** 2025-04-27T04:40:52Z  
**内容:**

# Devcontainerの導入

## 概要
開発環境の統一とセットアップの簡略化のため、devcontainerを導入する

## 目的
- チーム全員が同じ開発環境で作業できるようにする
- 新規開発者のオンボーディングを簡略化する
- CI/CD環境との一貫性を確保する

## タスク
- [x] `.devcontainer`ディレクトリの作成
- [x] `devcontainer.json`の設定
  - Node.js 20の環境設定
  - 必要なVS Code拡張機能の設定
  - 自動フォーマットの設定
  - etc
- [x] `Dockerfile`の作成
- [x] READMEの作成

**コメント:** なし

---

### [収支報告書のフォーマット調査](https://github.com/digitaldemocracy2030/polimoney/issues/20)

**作成者:** shumizu418128  
**作成日:** 2025-04-24T16:28:40Z  
**内容:**

## 背景
政治資金収支報告書は、提出先（各都道府県の選挙管理委員会、総務省）や報告主体（政党、資金管理団体、その他の政治団体など）によってフォーマットが異なることが分かっています。

このフォーマットの多様性は、OCRによる報告書の自動読み取りを進める上で大きな障壁となっています。

## 目的

- **フォーマットの網羅的調査**: 全国の都道府県、国レベルで提出される収支報告書、および団体の種類（政党本部・支部、資金管理団体、その他の政治団体等）によるフォーマットの違いを調査し、実例を収集します。

- **パターン化・分類**: 収集したフォーマットを分析し、共通点、相違点、特有のレイアウトなどを特定し、体系的にパターン化・分類します。

- **課題の理解深化**: 報告書フォーマットの現状を把握することで、データ化における技術的課題や、報告書作成者（政治家側）・利用者（国民側）双方にとっての潜在的な課題（分かりにくさ、比較の難しさ等）への理解を深めます。

- **OCR精度向上の基盤構築**: 特定されたフォーマットパターン情報を、将来的なデータ抽出ロジックの改善に活用します。

## 具体的なタスク

- **情報収集**:
  - 各都道府県の選挙管理委員会、総務省のウェブサイト等を調査し、公開されている政治資金収支報告書のPDFファイルや様式テンプレートを収集します。（例: 「〇〇県 政治資金収支報告書」、「総務省 政治資金収支報告書」等のキーワードで検索）

- **フォーマット分析**:
  - 収集した報告書の構成要素（表紙、収入、支出、資産等の各項目、明細書など）を確認します。
  - レイアウト、記載項目、様式番号（例: 様式その〇〇）の違いを比較・分析します。
  - 特にOCR処理で問題となりそうな箇所（罫線の有無・種類、手書き箇所の多さ、特有の注釈など）に注目します。

※ なんとなくの感想程度で構いません。**ハイレベルな文を書くより、収支報告書とかいう謎文書の手ごわさを理解するほうが大事**だと思います。

- **結果の整理・文書化**:
  - 特定したフォーマットパターンごとに、特徴、出典（都道府県/国、団体種類、年度）、該当する様式のサンプル画像（またはファイルへのリンク）を整理します。

整理した情報は、**[TODO: 記録先未定 提案募集中]** に記録します。

---

めっちゃGeminiに手伝ってもらいましたが、このissueは一応 @shumizu418128 自分で書いています。
本件は私のタスクに直結するので、現時点で本件の主担当は私 @shumizu418128 です。

polimoneyのコンセプトに対する理解への貢献、取り組みやすさの観点から、これはgood first issueになると思います。

**コメント:** なし

---

### [OCR（画像認識）の精度強化](https://github.com/digitaldemocracy2030/polimoney/issues/19)

**作成者:** shumizu418128  
**作成日:** 2025-04-23T14:10:03Z  
**内容:**

ただのメモ
4/23現在、OCR・Geminiまわりの担当は清水のみです
 
### なるべく処理ログを残す
  - どの座標をどんな文字と認識したのか記録
  - 合計金額を計算し記録（「小計」の活用）
  - 手書き文字・訂正印が邪魔で読みにくい部分を記録
  - 備考などのイレギュラー対策の検討
  - 必要に応じて画像をトリミング

目標：バグ発生時の迅速な対応を実現する

### json形式の統一
  - DBとのやりとりはPinさん担当なので相談する
  - 上記処理ログ含め残したい


[参考：4/23 ミーティングログ](https://docs.google.com/document/d/19Kn6ekK3twMVcVaSyUgptvmfzrXEJezA6GXTbPXjm9M/edit?tab=t.0)

**コメント:** なし

---

### [議員からの掲載許可に基づくデータ表示制御（オプトイン・アウト）機能](https://github.com/digitaldemocracy2030/polimoney/issues/5)

**作成者:** Olemi-llm-apprentice  
**作成日:** 2025-04-12T07:24:22Z  
**内容:**

**背景:**
Polimoney プロジェクトで扱う政治資金収支報告書のデータは機微情報を含む可能性があり、分析結果や元データの公開にあたっては、関連する議員等からの掲載許可が必要となるケースが想定されます。許可が得られた情報のみを適切に公開し、許可が得られていない情報は非公開とする運用が求められます。

**課題:**
現在のシステム（データ処理パイプライン、および将来的な表示インターフェース）には、議員や団体ごとの掲載許可状況に基づいてデータの公開範囲を制御する仕組みがありません。このため、許可が得られたタイミングで迅速かつ正確に情報を公開したり、逆に許可が得られていない情報を確実に非公開にしたりすることが困難です。

**提案:**
議員や政治団体からの掲載許可状況に応じて、関連するデータの公開/非公開を制御できるオプトイン・アウト機能を実装します。

1.  **許可ステータス管理:**
    *   各議員や団体、あるいは分析対象のデータセット（例: 特定の収支報告書に対応する JSON データ）に対して、掲載許可の有無を示すステータス（例: `publication_approved: true/false`, `opt_in_status: granted/pending/denied` など）を管理する仕組みを導入します。
    *   このステータスをデータ自体（例: JSON ファイル内）に含めるか、別途管理データベースを用意するかを検討します。
2.  **ステータス更新プロセス:**
    *   議員等から掲載許可が得られた、あるいは取り下げられた場合に、上記ステータスを更新するためのプロセス（手動更新、管理ツール、API など）を定義・実装します。
3.  **表示ロジックへの反映:**
    *   データを利用して情報を表示するコンポーネント（例: Web アプリケーション、分析レポート生成ツールなど）において、この許可ステータスをチェックし、許可されているデータのみを表示（オプトイン）、または許可されていないデータを非表示（オプトアウト）にするロジックを組み込みます。
4.  **デフォルト状態の定義:**
    *   許可ステータスが未設定の場合のデフォルトの挙動（デフォルトで公開か非公開か）を明確に定義します。（通常はデフォルト非公開が安全）

**期待される効果:**

*   議員等からの掲載許可が得られたデータのみを、迅速かつ適切に公開できるようになる。
*   許可が得られていない情報の意図しない公開を防ぎ、コンプライアンスを遵守できる。
*   プロジェクトの透明性と信頼性を高める。

**担当者:** (任意)
**ラベル:** enhancement, feature, compliance, data privacy


**コメント:** なし

---

### [総務省ウェブサイトからの政治資金収支報告書PDF自動取得機能](https://github.com/digitaldemocracy2030/polimoney/issues/4)

**作成者:** Olemi-llm-apprentice  
**作成日:** 2025-04-12T07:21:37Z  
**内容:**

**背景:**
政治資金収支報告書の分析には、まず総務省のウェブサイトから対象となる報告書の PDF ファイルを入手する必要があります。現在は、以下のページから手動で目的の団体を探し、PDF をダウンロードする必要があります。

*   参照サイト: [政治資金収支報告書（令和6年11月29日公表（令和5年分定期公表））](https://www.soumu.go.jp/senkyo/seiji_s/seijishikin/reports/SS20241129/)

この手作業は、特に多数の団体を対象とする場合、非常に時間がかかり非効率です。

**課題:**

*   総務省のウェブサイト構造を解析し、目的の団体の報告書 PDF へのリンクを特定する必要がある。
*   ウェブサイトは団体種別（政党本部、政党支部、資金管理団体など）や、あいうえお順のインデックスで構成されており、目的の団体を見つけるために複数のページをナビゲートする必要がある場合がある。
*   手動でのダウンロードは時間と手間がかかる。

**提案:**
総務省のウェブサイトをクローリングし、指定された条件に基づいて政治資金収支報告書の PDF ファイルを自動でダウンロードするスクリプト機能を追加します。

1.  **ウェブスクレイピングの実装:**
    *   Python ライブラリ（例: `requests`, `BeautifulSoup4`）を使用して、上記の総務省のウェブサイトを解析します。
2.  **対象指定機能:**
    *   コマンドライン引数や設定ファイルで、ダウンロード対象とする報告書の公表年、団体種別（政党本部、支部、資金管理団体、その他の政治団体）、特定の団体名などを指定できるようにします。
3.  **リンク探索とダウンロード:**
    *   指定された条件に基づき、ウェブサイトのリンクをたどり、該当する団体の報告書 PDF へのリンクを特定します。
    *   特定したリンクから PDF ファイルをダウンロードし、分かりやすい命名規則（例: `報告年_団体名_種別.pdf`）で指定されたディレクトリに保存します。
4.  **負荷への配慮:**
    *   総務省サーバーへの過度な負荷を避けるため、リクエスト間に適切な待機時間（例: `time.sleep()`）を設けます。また、総務省の `robots.txt` や利用規約を尊重します。

**期待される効果:**
政治資金収支報告書 PDF の収集プロセスが自動化され、分析作業の準備にかかる時間と手間が大幅に削減される。

**担当者:** (任意)
**ラベル:** enhancement, web scraping, data acquisition, automation

**コメント:** なし

---

### [Gemini API呼び出しの並列化とエラーハンドリング強化（レートリミット対応）](https://github.com/digitaldemocracy2030/polimoney/issues/3)

**作成者:** Olemi-llm-apprentice  
**作成日:** 2025-04-12T07:16:30Z  
**内容:**

**背景:**
`analyze_image_gemini.py` は、1枚ずつ画像を Gemini API に送信して解析を実行します。多数の画像ページ（PDFから変換されたものなど）を処理する場合、この逐次処理は全体の完了までに非常に長い時間がかかります。また、API 呼び出しはネットワークエラーや API 側のレートリミット（利用制限）などにより失敗する可能性があります。

**課題:**

1.  **処理時間の長さ:** 多数の画像を処理する際の全体的なスループットが低い。
2.  **レートリミットエラー:** Gemini API のレートリミットに達した場合、処理が中断してしまう。
3.  **一時的なエラー:** ネットワークの不安定さなどによる一時的なエラーが発生した場合、処理が失敗してしまう。

**提案:**
スクリプトのパフォーマンスと安定性を向上させるために、以下の改善を実装します。

1.  **並列処理の実装:**
    *   複数の画像解析リクエストを同時に Gemini API へ送信できるように、並列処理（マルチスレッド、マルチプロセス、または非同期処理）を導入します。Python の `concurrent.futures` や `asyncio` ライブラリの活用を検討します。
    *   並列度（同時に実行するリクエスト数）を設定可能にし、実行環境や API の制限に応じて調整できるようにします。
2.  **レートリミット対応:**
    *   Gemini API からレートリミットエラー（例: HTTP 429 Too Many Requests）が返された場合に、処理を即座に中断するのではなく、一定時間待機してからリクエストを再試行するロジック（例: Exponential Backoff）を実装します。
3.  **リトライ処理の強化:**
    *   レートリミット以外の特定の一時的なエラー（ネットワークエラーなど）に対しても、リトライ処理を実装します。
4.  **エラーハンドリングの改善:**
    *   リトライしても最終的に失敗したリクエストや、その他の予期せぬエラーが発生した場合でも、全体処理が停止しないようにエラーハンドリングを強化します。失敗した画像とその理由を記録し、後で確認できるようにします。

**期待される効果:**

*   複数の画像ファイルを処理する際の全体的な実行時間が大幅に短縮される。
*   API のレートリミットや一時的なネットワークエラーに対する耐性が向上し、スクリプトの安定性が向上する。
*   エラーが発生した場合でも、成功した処理は維持され、失敗した処理を特定しやすくなる。

**担当者:** (任意)
**ラベル:** enhancement, performance, error handling, api


**コメント:** なし

---

## Pull Requests

### 過去7日間にマージされたPR (8件)

### [update readme](https://github.com/digitaldemocracy2030/polimoney/pull/58)

**作成者:** dotneet  
**作成日:** 2025-05-14T03:48:23Z  
**変更:** +1 -1 (1ファイル)  
**マージ日:** 2025-05-14T04:02:21Z  
**内容:**

# 変更の概要
<!-- ここに変更の概要を記載してください -->

npm install できないため

**コメント:** なし

---

### [reactのレンダリング時の警告修正](https://github.com/digitaldemocracy2030/polimoney/pull/52)

**作成者:** dotneet  
**作成日:** 2025-05-12T05:22:48Z  
**変更:** +1 -1 (1ファイル)  
**マージ日:** 2025-05-13T05:52:24Z  
**内容:**

id: '14-2' が重複していて警告が出ていて気になったので修正です。
<img width="437" alt="image" src="https://github.com/user-attachments/assets/3f2cb58f-e561-4fcf-8f92-56308f124477" />


**コメント:** なし

---

### [cla追加, プルリク & issueのテンプレート追加,  自己アサイン機能追加](https://github.com/digitaldemocracy2030/polimoney/pull/49)

**作成者:** moai-redcap  
**作成日:** 2025-05-09T08:00:53Z  
**変更:** +124 -0 (5ファイル)  
**マージ日:** 2025-05-12T12:25:55Z  
**内容:**

cla.mdの追加、
プルリク, issueそれぞれのテンプレートを追加しました。
また、/assignで自己assignできるようにしました。
#12 
#18 

**コメント:** なし

---

### [gemini 2.5 pro preview 05-26 導入](https://github.com/digitaldemocracy2030/polimoney/pull/44)

**作成者:** shumizu418128  
**作成日:** 2025-05-07T00:44:04Z  
**変更:** +2 -2 (1ファイル)  
**マージ日:** 2025-05-13T05:50:27Z  
**内容:**

[geminiにアップデートが入りました](https://developers.googleblog.com/en/gemini-2-5-pro-io-improved-coding-performance/)

**コメント:** なし

---

### [docs: Add Japanese translation of project documentation](https://github.com/digitaldemocracy2030/polimoney/pull/43)

**作成者:** obama00300+Devin  
**作成日:** 2025-05-06T13:09:18Z  
**変更:** +962 -0 (5ファイル)  
**マージ日:** 2025-05-13T05:48:55Z  
**内容:**

# 日本語ドキュメントの追加

このPRでは、Polimoneyプロジェクトのドキュメントを日本語に翻訳し、`docs/wiki_ja.md`として追加しています。

## 変更内容

- プロジェクトの概要、構成、主要コンポーネント、および用語集を日本語に翻訳
- `docs`ディレクトリを作成し、翻訳したドキュメントを追加

## リンク

- [Link to Devin run](https://app.devin.ai/sessions/ff9bd4a6b4e84c15b2fd837436438e1c)
- 依頼者: obama00300@gmail.com


**コメント:** なし

---

### [Devin wikiコンテンツのドキュメント追加](https://github.com/digitaldemocracy2030/polimoney/pull/42)

**作成者:** obama00300+Devin  
**作成日:** 2025-05-06T07:55:38Z  
**変更:** +65 -0 (2ファイル)  
**マージ日:** 2025-05-13T05:48:07Z  
**内容:**

# Devin wikiコンテンツのドキュメント追加

## 概要
このPRでは、Devinとの協働に関するドキュメントをPolimoney用に追加しています。これらのファイルは、GitHub wikiが有効になった後にwikiコンテンツとして使用することができます。

## 変更内容
- `docs/DEVIN_COLLABORATION.md`: Devinとの協働方法に関するドキュメント
- `docs/Home.md`: wikiのホームページ用テンプレート

## GitHub wikiの有効化と設定方法
現在、Polimoneyリポジトリにはwiki機能が無効になっています。以下の手順でwikiを有効にし、コンテンツを追加できます：

1. リポジトリの設定ページ（Settings）に移動
2. 「Features」セクションで「Wikis」を有効にする
3. wikiページに移動し、コンテンツを追加

## Link to Devin run
https://app.devin.ai/sessions/e3837c2614284fbc8c05d348af492ccc

## Requested by
obama00300@gmail.com


**コメント:** なし

---

### [収支報告書の表現に合わせて修正](https://github.com/digitaldemocracy2030/polimoney/pull/39)

**作成者:** shumizu418128  
**作成日:** 2025-05-02T13:14:05Z  
**変更:** +11 -11 (1ファイル)  
**マージ日:** 2025-05-14T07:09:56Z  
**内容:**

tsでの表現：翌年度への繰越
gemini & 収支報告書での表現：翌年への繰越額
前年も同様

収支報告書の表記に合わせたほうがGemini出力を流すうえでラクだと思うので、修正させていただきたくPRを書きました。

**コメント:** なし

---

### [update readme](https://github.com/digitaldemocracy2030/polimoney/pull/24)

**作成者:** adust09  
**作成日:** 2025-04-27T04:05:02Z  
**変更:** +27 -1 (1ファイル)  
**マージ日:** 2025-05-13T05:46:06Z  
**内容:**

AIに書かせたREADMEであり、一部コマンドは私の方でまだ検証できていません。


**コメント:** なし

---

### 過去7日間に作成されたPR (7件)

### [pythonにruff, pyrightを導入](https://github.com/digitaldemocracy2030/polimoney/pull/59)

**作成者:** dotneet  
**作成日:** 2025-05-14T05:35:22Z  
**変更:** +131 -4 (4ファイル)  
**内容:**

# 変更の概要
<!-- ここに変更の概要を記載してください -->
 - type checkerの導入(pyright)
 - linter, formatterの導入(ruff)
 - CIでの上記のチェック

ruffのルールはいったん適用なしにしてます。
かなりエラーが多いので全部有効にして ignore で対処する方法も使いづらいため。

# スクリーンショット
<!-- UIの変更を伴う場合は、変更前後のスクリーンショットもしくはgif画像をこちらに記載してください -->

# 変更の背景
<!-- ここに変更が必要となった背景を記載してください -->

 - コードの保守性向上のため

# 関連Issue
<!-- 関連するIssueのリンクをこちらに記載してください -->

 - #34

# CLAへの同意
本リポジトリへのコントリビュートには、[コントリビューターライセンス契約（CLA）](https://github.com/digitaldemocracy2030/idobata/blob/main/CLA.md)に同意することが必須です。

内容をお読みいただき、下記のチェックボックスにチェックをつける（"- [ ]" を "- [x]" に書き換える）ことで同意したものとみなします。

- [x] CLAの内容を読み、同意しました


**コメント:** なし

---

### [Biome + lefthookの導入](https://github.com/digitaldemocracy2030/polimoney/pull/57)

**作成者:** dotneet  
**作成日:** 2025-05-12T13:20:22Z  
**変更:** +2010 -4847 (31ファイル)  
**内容:**

# 変更の概要
<!-- ここに変更の概要を記載してください -->

fix #54 

 - Biomeとlefthookの導入
 - ESLintの削除(BiomeにLint機能があるため)
 - anyがエラーになってしまうので、いったん warn にしてあります。anyへの対応は進めるとしても別途PRでよいかと思い、いったんそこは保留にしてます。

フォーマット後サイトがちゃんと動くことを確認済みです。

# スクリーンショット
<!-- UIの変更を伴う場合は、変更前後のスクリーンショットもしくはgif画像をこちらに記載してください -->

# 変更の背景
<!-- ここに変更が必要となった背景を記載してください -->

フォーマッターがなく個々人の環境でソースのフォーマットが変わってしまうため。

# 関連Issue
<!-- 関連するIssueのリンクをこちらに記載してください -->

 - #54 

# CLAへの同意
本リポジトリへのコントリビュートには、[コントリビューターライセンス契約（CLA）](https://github.com/digitaldemocracy2030/idobata/blob/main/CLA.md)に同意することが必須です。

内容をお読みいただき、下記のチェックボックスにチェックをつける（"- [ ]" を "- [x]" に書き換える）ことで同意したものとみなします。

- [x] CLAの内容を読み、同意しました


**コメント:** なし

---

### [analyze_image_gemini.py のエラーハンドリング改善](https://github.com/digitaldemocracy2030/polimoney/pull/55)

**作成者:** dotneet  
**作成日:** 2025-05-12T10:48:11Z  
**変更:** +201 -43 (3ファイル)  
**内容:**

 - #3 関連の対応です。すべてが終わったわけではありません。エラーハンドリングのみの対応です。
 - loggingの導入(printもloggingに切り替え)
 - 一部のエラーを最大5回まで指数バックオフでリトライするように変更
 - エラーが発生した項目は error_log.json に出力して、すべての実行完了後に確認可能

下記、確認済みです。
・リトライが実行されること
・エラーのアイテムが error_log.json に吐き出されること
・これまで通り正常に画像からJSONファイルに変換できること


**コメント:** なし

---

### [pinact runでバージョンをコミットハッシュにする](https://github.com/digitaldemocracy2030/polimoney/pull/50)

**作成者:** hatsu38  
**作成日:** 2025-05-10T15:49:14Z  
**変更:** +9 -9 (2ファイル)  
**内容:**

- git tagは変更可能なためセキュリティのリスクもあります
- 先日 [tj-actions/changed-files](https://github.com/tj-actions/changed-files) ではいくつものタグが特定の悪意ある コミットハッシュに置き換えられてしまう事案がありました
  - https://www.stepsecurity.io/blog/harden-runner-detection-tj-actions-changed-files-action-is-compromised
- GitHub CI/CD実践ガイドという本 にも、gitのコミットタグは可変なため、コミットハッシュで固定するのを推奨しています
- そこで  [pinact run](https://github.com/suzuki-shunsuke/pinact) コマンドを実行してバージョンをコミットハッシュに置き換えました


コミットハッシュによって最新のパッチバージョンを利用するためにはバージョンアップの必要がありますが、dependabot  などでそれほど不可なくバージョンの更新はしていけると思います。
その面倒さ以上に、セキュリティリスクの高さが上まると考えて、PRを提出しました。


**コメント:** なし

---

### [E2E - merge_jsons.py変更](https://github.com/digitaldemocracy2030/polimoney/pull/48)

**作成者:** shumizu418128  
**作成日:** 2025-05-07T15:02:55Z  
**変更:** +33 -10 (1ファイル)  
**内容:**

#47 に関連して、Geminiのプロンプトを変更したことに伴う出力jsonの変更を反映し、うまくjsonファイルをmergeするためのコードです。

一番最後のjsonファイルから、年度を読み取る(宣誓書の年)と15行目に書かれていますが、必ずしも宣誓書は最後のページであるという確認はとれていません（ほとんどの場合最後のようです）
ここは今後改修の必要があるかもしれません

**コメント:** なし

---

### [E2E - Geminiプロンプト変更](https://github.com/digitaldemocracy2030/polimoney/pull/47)

**作成者:** shumizu418128  
**作成日:** 2025-05-07T14:28:14Z  
**変更:** +56 -56 (1ファイル)  
**内容:**

converter.tsの形式に合わせた形で、Geminiに出力させることがねらいです。

現在、収支報告書をGeminiに読ませてjson出力させ、それらをまとめたall.jsonを作っても、converter.tsで形式エラーが発生している状況です。
これを解決するために、まずはGeminiにconverter.tsの想定する形式（= sample_input.jsonの形式）にさせることをねらいとしています。
[新しいプロンプトを利用して出力したものはこちらです](https://github.com/shumizu418128/polimoney/blob/test-only/output_json/05teiki-jimin_365_page_02.json)

なお、新しいプロンプトを使って作ったjsonファイルたちをそのままmerge_jsons.pyにかけると、エラーが出てマージできません。merge_jsons.pyの想定外の形式になってしまうためです。
かといってGeminiのプロンプトをこのまま変更せず（＝このプルリクをmergeしない）、merge_jsons.pyの変更のみでconverter.tsの想定する形式に持っていくことはできません。converter.tsにとって必要な情報が不足しているためです。

まずGeminiにconverter.tsの想定する形式を出力させ、後ほどmerge_jsons.pyのプルリクを出し、最終的にall.jsonをconverter.tsの想定する形式にする考えです。

よろしくお願いします。

**コメント:** なし

---

### [DevContainer configuration with Dockerfile, README, and VS Code settings](https://github.com/digitaldemocracy2030/polimoney/pull/45)

**作成者:** adust09  
**作成日:** 2025-05-07T08:59:38Z  
**変更:** +135 -0 (4ファイル)  
**内容:**

#25 
立ち上げとlocalhostの接続まで確認済みです。
利用するextensionなどは議論の余地があると思います。

**コメント:** なし

---

### 過去7日間に更新されたPR（作成・マージを除く）(1件)

### [all.jsonをsample_input.json形式に変換するスクリプト](https://github.com/digitaldemocracy2030/polimoney/pull/38)

**作成者:** hagi5  
**作成日:** 2025-05-02T11:55:29Z  
**変更:** +276 -0 (1ファイル)  
**内容:**

## 目的
https://github.com/digitaldemocracy2030/polimoney/issues/29 のall.jsonをdata/sample_input.json っぽいデータに変換する

### 補足
カテゴリの分類のためにページ番号が欲しかったので all.json をページごとのデータにsplitしています
[all_page2.json](https://github.com/user-attachments/files/20012673/all_page2.json)

## 使い方
```shell
python tools/convert.py tools/merged_files/all_page2.json -o output.json
````
## 出力サンプル
[output.json](https://github.com/user-attachments/files/20012442/output.json)

## レビューしていただきたい点

- 出力サンプルが最低限使えるものかどうか
  - ここをもっとこうしてほしいなど指摘があればお願いします
- all_page2.jsonにページ番号を含めたことの是非


**コメント:** なし

---

